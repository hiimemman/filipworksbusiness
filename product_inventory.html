<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">
  <link rel="icon" href="favicon.ico">
  <title>Tiny Dashboard - A Bootstrap Dashboard Template</title>
  <!-- Simple bar CSS -->
  <link rel="stylesheet" href="css/simplebar.css">
  <!-- Fonts CSS -->
  <link
    href="https://fonts.googleapis.com/css2?family=Overpass:ital,wght@0,100;0,200;0,300;0,400;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,600;1,700;1,800;1,900&display=swap"
    rel="stylesheet">
  <!-- Icons CSS -->
  <link rel="stylesheet" href="css/feather.css">
  <link rel="stylesheet" href="css/dataTables.bootstrap4.css">
  <!-- Date Range Picker CSS -->
  <link rel="stylesheet" href="css/daterangepicker.css">
  <!-- App CSS -->
  <link rel="stylesheet" href="css/app-light.css" id="lightTheme">
  <link rel="stylesheet" href="css/app-dark.css" id="darkTheme" disabled>
  
  <link href="//cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/css/toastr.min.css" rel="stylesheet" />
  <!-- <link href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet" /> -->
  <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/3.2.1/css/font-awesome.min.css" rel="stylesheet" />
  <link href="./css/style.css" rel="stylesheet" />

  <script>

    const token = localStorage.getItem('token');

    if (!token) {
      // Redirect to the dashboard page
      window.location.href = 'login.html';
    }


  </script>
</head>

<body class="vertical  light  ">
  <div class="wrapper">
    <nav id="topnav">
      <nav class="topnav navbar navbar-light">
        <button type="button" class="navbar-toggler text-muted mt-2 p-0 mr-3 collapseSidebar">
          <i class="fe fe-menu navbar-toggler-icon"></i>
        </button>

        <ul class="nav">
          <!-- <li class="nav-item">
                <a class="nav-link text-muted my-2" href="#" id="modeSwitcher" data-mode="light">
                    <i class="fe fe-sun fe-16"></i>
                </a>
            </li> -->


          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle text-muted pr-0" href="#" id="navbarDropdownMenuLink" role="button"
              data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              <span class="avatar avatar-sm mt-2">
                <img src="./assets/avatars/face-1.jpg" alt="..." class="avatar-img rounded-circle">
              </span>
            </a>
            <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdownMenuLink">
              <a class="dropdown-item" href="#">Profile</a>
              <a class="dropdown-item" href="#">Settings</a>
              <!-- <a class="dropdown-item" href="#">Activities</a> -->
            </div>
          </li>
        </ul>
      </nav>
    </nav>
    <aside id="sidebar">
      <aside class="sidebar-left border-right bg-white shadow" id="leftSidebar" data-simplebar>

        <nav class="vertnav navbar navbar-light">

          <div class="w-100 mb-4 d-flex">

            <img src="assets/filipworks.svg" alt="" width="200" height="100">

          </div>
          <ul class="navbar-nav flex-fill w-100 mb-2">
            <li class="nav-item dropdown">
              <a href="index.html" id="dashboard" class="nav-link" aria-expanded="false">
                <i class="fe fe-home fe-16"></i>
                <span class="ml-3 item-text">Dashboard</span>
                <span class="sr-only">(current)</span>
              </a>

            </li>
          </ul>
          <p class="text-muted nav-heading mt-4 mb-1">
            <span>Data</span>
          </p>
          <ul class="navbar-nav flex-fill w-100 mb-2">
            <li class="nav-item w-100">
              <a class="nav-link" id="businessinfo" href="table_datatables.html" aria-expanded="false">
                <i class="fe fe-briefcase fe-16"></i>
                <span class="ml-3 item-text">Business Info</span>
              </a>
            </li>

            <li class="nav-item w-100">
              <a class="nav-link" id="goalsettings" href="goal_settings.html" aria-expanded="false">
                <i class="fe fe-target fe-16"></i>
                <span class="ml-3 item-text">Goal Settings</span>
              </a>
            </li>

            <li class="nav-item w-100">
              <a class="nav-link" id="expenseslist" href="expense_list.html" aria-expanded="false">
                <!-- <i class="fe fe-dollar-sign fe-16"></i> -->
                <i class="fe-16">â‚±</i>
                <span class="ml-3 item-text">Expenses List</span>
              </a>
            </li>

            <li class="nav-item w-100">
              <a class="nav-link" id="supplyinventory" href="supply_inventory.html" aria-expanded="false">
                <i class="fe fe-box fe-16"></i>
                <span class="ml-3 item-text">Supply Inventory</span>
              </a>
            </li>
            <li class="nav-item w-100">
              <a class="nav-link" id="pricinglist" href="pricing_list.html" aria-expanded="false">
                <i class="fe fe-list fe-16"></i>
                <span class="ml-3 item-text">Pricing List</span>
              </a>
            </li>

            <li class="nav-item w-100">
              <a id="productinventory" href="product_inventory.html" aria-expanded="false">
                <i class="fe fe-shopping-bag fe-16"></i>
                <span class="ml-3 item-text">Product Inventory</span>
              </a>
            </li>


            <li class="nav-item w-100">
              <a class="nav-link" id="salesrevenue" href="sales_revenue.html" aria-expanded="false">
                <i class="fe fe-activity fe-16"></i>
                <span class="ml-3 item-text">Sales Revenue</span>
              </a>
            </li>

            <li class="nav-item w-100">
              <a class="nav-link" id="customertracker" href="customer_tracker.html" aria-expanded="false">
                <i class="fe fe-map-pin fe-16"></i>
                <span class="ml-3 item-text">Customer Tracker</span>
              </a>
            </li>
            <li class="nav-item w-100">
              <a class="nav-link" id="invoicetracker" href="invoice_tracker.html" aria-expanded="false">
                <i class="fe fe-file fe-16"></i>
                <span class="ml-3 item-text">Invoice Tracker</span>
              </a>
            </li>

            <li class="nav-item w-100">
              <a class="nav-link" id="invoicegenerator" href="invoice_generator.html" aria-expanded="false">
                <i class="fe fe-file-plus fe-16"></i>
                <span class="ml-3 item-text">Invoice Generator</span>
              </a>
            </li>
          
        </nav>
      </aside>
    </aside>
    <main role="main" class="main-content">
      <div class="container-fluid">
        <div class="row justify-content-center">
          <div class="col-12">
            <!-- <h2 class="mb-2 page-title">Data table</h2>
            <p class="card-text">DataTables is a plug-in for the jQuery Javascript library. It is a highly flexible
              tool, built upon the foundations of progressive enhancement, that adds all of these advanced features to
              any HTML table. </p> -->



            <h3 class="mb-3 m-3">PRODUCT INVENTORY</h3>

            <div class="row">

              <div class="col-md-6 col-xl-3 mb-4">
                <div class="card shadow bg-primary text-white border-0">
                  <div class="card-body">
                    <div class="row align-items-center">
                      <div class="col-3 text-center">
                        <span class="circle circle-sm bg-white">
                          <i class="fe fe-16 fe-shopping-bag text-primary mb-0"></i>
                        </span>
                      </div>
                      <div class="col pr-0">
                        <p class="small text-white mb-0">AVERAGE ITEM VALUE</p>
                        <span class="h3 mb-0 text-white" id ="cardAverageItemValue"></span>

                      </div>
                    </div>
                  </div>
                </div>
              </div>



              <div class="col-md-6 col-xl-3 mb-4">
                <div class="card shadow bg-success text-white border-0">
                  <div class="card-body">
                    <div class="row align-items-center">
                      <div class="col-3 text-center">
                        <span class="circle circle-sm bg-white">
                          <i class="fe fe-16 fe-shopping-bag text-success mb-0"></i>
                        </span>
                      </div>
                      <div class="col pr-0">
                        <p class="small text-white mb-0">IN STOCK</p>
                        <span class="h3 mb-0 text-white" id ="cardInStock"></span>

                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-md-6 col-xl-3 mb-4">
                <div class="card shadow border-0 bg-warning">
                  <div class="card-body">
                    <div class="row align-items-center">
                      <div class="col-3 text-center">
                        <span class="circle circle-sm bg-white">
                          <i class="fe fe-16 fe-shopping-cart text-warning mb-0"></i>
                        </span>
                      </div>
                      <div class="col pr-0">
                        <p class="small mb-0 text-white">LOW STOCK</p>
                        <span class="h3 mb-0 text-white" id ="cardLowStock"></span>

                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-md-6 col-xl-3 mb-4">
                <div class="card shadow border-0 bg-danger">
                  <div class="card-body">
                    <div class="row align-items-center">
                      <div class="col-3 text-center">
                        <span class="circle circle-sm bg-white">
                          <i class="fe fe-16 fe-shopping-cart text-danger mb-0"></i>
                        </span>
                      </div>
                      <div class="col pr-0">
                        <p class="small mb-0 text-white">OUT OF STOCK</p>
                        <span class="h3 mb-0 text-white" id ="cardOutOfStock"></span>

                      </div>
                    </div>
                  </div>
                </div>
              </div>



            </div>

            <hr class="solid">

            
            <div class="col-md-12">
              <h6 class="mb-3">Note: Your list of products is automatically linked below. Edit the YELLOW AREAS only. To
                add product stock inventory, scroll to the right and list the production information for newly added
                stocks. Added stocks will automatically add up here, and sold stocks from "Sales Revenue" will be
                automatically deducted. (If this sheet is not needed like for service business, you may disregard it.)

              </h6>


              <div class="mb-4">
                <div class="card shadow">
                  <div class="card-body">
                    <ul class="nav nav-tabs mb-3" id="pills-tab" role="tablist">
                      <li class="nav-item">
                        <a class="nav-link active" id="pills-home-tab" data-toggle="pill" href="#pills-home" role="tab"
                          aria-controls="pills-home" aria-selected="true">Products</a>
                      </li>
                      <li class="nav-item">
                        <a class="nav-link" id="pills-profile-tab" data-toggle="pill" href="#pills-profile" role="tab"
                          aria-controls="pills-profile" aria-selected="false">Newly Added Stocks</a>
                      </li>

                    </ul>
                    <div class="tab-content mb-1" id="pills-tabContent">
                      <div class="tab-pane fade show active" id="pills-home" role="tabpanel"
                        aria-labelledby="pills-home-tab">
                        
<!-- 
                        ADD PRODUCT -->
                        
                        <button type="button" class="btn mb-2 btn-success text-white col-sm-1" data-toggle="modal" data-target="#modalAddProduct">Add</button>

                      <!-- Modal -->
                      <div class="modal fade" id="modalAddProduct" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered" role="document">
                          <div class="modal-content">
                            <div class="modal-header">
                              <h5 class="modal-title" id="exampleModalLongTitle">Add Product</h5>
                              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                              </button>
                            </div>
                            <div class="modal-body">
                              <form id="frmAddProduct">
                                <img id="imgProductSelected" src="https://cdn3.iconfinder.com/data/icons/photo-tools/65/upload-1024.png" class="img-thumbnail" alt="No image" style="width: 300px; height: 300px; margin-bottom: 1rem;">
                                <div class="form-group">
                                  <label for="uploadImageInputProduct">Upload Product Image</label>
                                  <input type="file" class="form-control-file" id="uploadImageInputProduct">
                                </div>
                          
                                <div class="form-group">
                                  <label for="addProductName" class="customizedFormLabel">Name</label>
                                  <input type="text" class="form-control" id="addProductName" placeholder="Enter product name">
                                </div>
                          
                                <div class="form-group">
                                  <label for="addProductDescription" class="customizedFormLabel">Description</label>
                                  <input type="text" class="form-control" id="addProductDescription" placeholder="Enter product description">
                                </div>
                          
                                <div class="form-group">
                                  <label for="addProductPrice" class="customizedFormLabel">Price</label>
                                  <div class="input-group mb-2">
                                    <div class="input-group-prepend">
                                      <div class="input-group-text">â‚±</div>
                                    </div>
                                    <input type="text" class="form-control" id="addProductPrice" placeholder="Price">
                                  </div>
                                </div>
                          
                                <div class="form-group">
                                  <label for="categoryProduct">Category</label>
                                  <select class="form-control" id="categoryProduct">
                                    <option>Electronics</option>
                                    <option>Clothing</option>
                                    <option>Furniture</option>
                                    <option>Appliances</option>
                                    <option>Toys</option>
                                    <option>Hygiene</option>
                                    <option>Food</option>
                                  </select>
                                </div>
                          
                                <div class="form-group">
                                  <label for="addProductStock" class="customizedFormLabel">Stock</label>
                                  <input type="text" class="form-control" id="addProductStock" placeholder="Enter product stock">
                                </div>
                          
                                <div class="modal-footer">
                                  <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                  <button type="submit" class="btn btn-primary">Save</button>
                                </div>
                              </form>
                            </div>
                          </div>
                        </div>
                      </div>

                        <div class="card-body">
                          <!-- table -->

                          <table class="table datatables" id="dataTable-1">
                            <thead>
                              <tr class="bg-primary text-white">
                                <!-- _id: string,
                                name: string,
                                description: string,
                                price: number,
                                category: string,
                                imageUrl: string,
                                stock: number,
                                createdAt: Date,
                                updatedAt: Date
                                sku: string,
                                lowStockAlert: number -->
                                <td>No</td>
                                <td>Name</td>
                                <td>Description</td>
                                <td>Price</td>
                                <td>Category</td>
                                <td>Image</td>
                                <th>Status</th>
                                <td>Stock</td>
                                <td>SKU</td>
                                <td>Last Date Updated</td>

                              </tr>
                            </thead>
                            <tbody>
                           
                            </tbody>
                          </table>
                        </div>

                      </div>
                      <div class="tab-pane fade show" id="pills-profile" role="tabpanel"
                        aria-labelledby="pills-profile-tab">
                        <button type="button" class="btn mb-2 btn-success text-white col-sm-1">Add</button>
<!-- 
                        ADD MODAL -->

                     

                      <!-- Modal -->
                      <div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered" role="document">
                          <div class="modal-content">
                            <div class="modal-header">
                              <h5 class="modal-title" id="exampleModalLongTitle">Modal title</h5>
                              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                              </button>
                            </div>
                            <div class="modal-body">
                              ...
                            </div>
                            <div class="modal-footer">
                              <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                              <button type="button" class="btn btn-primary">Save changes</button>
                            </div>
                          </div>
                        </div>
                      </div>

                        <div class="card-body">
                          <!-- table -->
                          <table class="table datatables" id="dataTable-2" style="width: 100%;">
                            <thead>
                              <tr class="bg-primary text-white">
                                <td>No</td>
                                <td>Production Date</td>
                                <td>Batch No.</td>
                                <td>Expiration Date</td>
                                <td>Product / Service Name</td>
                                <td>Item Code (SKU)</td>
                                <td>Stocks Added</td>
                                <td>Notes</td>

                                <td>Action</td>

                              </tr>
                            </thead>
                            <tbody>
                             


                            </tbody>
                          </table>
                        </div>
                      </div>

                    </div>
                  </div>
                </div>

                <!-- <div class="card shadow">
                <div class="card-body">
                  
                  <table class="table datatables" id="dataTable-1">
                    <thead>
                      <tr>
                        <th>No</th>
                        <th>Item Description</th>
                        <th>Supplier/Brand</th>
                        <th>Unit per Piece</th>
                        <th>Unit Symbol</th>
                        <th>Price</th>
                        <th>Value Ratio (Units/Price)</th>
                        <th>Last Date Updated</th>
                        <th>Status</th>
                        <th>Available Stocks</th>
                        <th>Stocks Needed</th>
                        <th>Stocks to Buy</th>
                        <th>Low Stock Alert Level</th>
                        <th>Inventory Value</th>
                        <th>Notes</th>
                        <th>Action</th>

                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>1</td>
                        <td>Chocolate Chips (1kg)
                        </td>
                        <td>Dutche
                        </td>
                        <td>1000.00
                        </td>
                        <td>g</td>
                        <td> 260.00
                        </td>
                        <td>3.85</td>
                        <td>(Sun) Nov. 10, 2030
                        </td>
                        <td class="bg-success text-white">In Stock</td>
                        <td>19.00</td>
                        <td>12.00</td>
                        <td>0.00</td>
                        <td>15.00</td>
                        <td>4,940.00</td>
                        <td></td>

                        <td><button class="btn btn-sm dropdown-toggle more-horizontal" type="button"
                            data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <span class="text-muted sr-only">Action</span>
                          </button>
                          <div class="dropdown-menu dropdown-menu-right">
                            <a class="dropdown-item" href="#">Edit</a>
                            <a class="dropdown-item" href="#">Remove</a>
                            <a class="dropdown-item" href="#">Assign</a>
                          </div>
                        </td>
                      </tr>


                    </tbody>
                  </table>
                </div>
              </div> -->
              </div>




              <!-- end section -->
            </div> <!-- .col-12 -->
          </div> <!-- .row -->
        </div> <!-- .container-fluid -->
        <div class="modal fade modal-notif modal-slide" tabindex="-1" role="dialog" aria-labelledby="defaultModalLabel"
          aria-hidden="true">
          <div class="modal-dialog modal-sm" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="defaultModalLabel">Notifications</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body">
                <div class="list-group list-group-flush my-n3">
                  <div class="list-group-item bg-transparent">
                    <div class="row align-items-center">
                      <div class="col-auto">
                        <span class="fe fe-box fe-24"></span>
                      </div>
                      <div class="col">
                        <small><strong>Package has uploaded successfull</strong></small>
                        <div class="my-0 text-muted small">Package is zipped and uploaded</div>
                        <small class="badge badge-pill badge-light text-muted">1m ago</small>
                      </div>
                    </div>
                  </div>
                  <div class="list-group-item bg-transparent">
                    <div class="row align-items-center">
                      <div class="col-auto">
                        <span class="fe fe-download fe-24"></span>
                      </div>
                      <div class="col">
                        <small><strong>Widgets are updated successfull</strong></small>
                        <div class="my-0 text-muted small">Just create new layout Index, form, table</div>
                        <small class="badge badge-pill badge-light text-muted">2m ago</small>
                      </div>
                    </div>
                  </div>
                  <div class="list-group-item bg-transparent">
                    <div class="row align-items-center">
                      <div class="col-auto">
                        <span class="fe fe-inbox fe-24"></span>
                      </div>
                      <div class="col">
                        <small><strong>Notifications have been sent</strong></small>
                        <div class="my-0 text-muted small">Fusce dapibus, tellus ac cursus commodo</div>
                        <small class="badge badge-pill badge-light text-muted">30m ago</small>
                      </div>
                    </div> <!-- / .row -->
                  </div>
                  <div class="list-group-item bg-transparent">
                    <div class="row align-items-center">
                      <div class="col-auto">
                        <span class="fe fe-link fe-24"></span>
                      </div>
                      <div class="col">
                        <small><strong>Link was attached to menu</strong></small>
                        <div class="my-0 text-muted small">New layout has been attached to the menu</div>
                        <small class="badge badge-pill badge-light text-muted">1h ago</small>
                      </div>
                    </div>
                  </div> <!-- / .row -->
                </div> <!-- / .list-group -->
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary btn-block" data-dismiss="modal">Clear All</button>
              </div>
            </div>
          </div>
        </div>
        <div class="modal fade modal-shortcut modal-slide" tabindex="-1" role="dialog"
          aria-labelledby="defaultModalLabel" aria-hidden="true">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="defaultModalLabel">Shortcuts</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body px-5">
                <div class="row align-items-center">
                  <div class="col-6 text-center">
                    <div class="squircle bg-success justify-content-center">
                      <i class="fe fe-cpu fe-32 align-self-center text-white"></i>
                    </div>
                    <p>Control area</p>
                  </div>
                  <div class="col-6 text-center">
                    <div class="squircle bg-primary justify-content-center">
                      <i class="fe fe-activity fe-32 align-self-center text-white"></i>
                    </div>
                    <p>Activity</p>
                  </div>
                </div>
                <div class="row align-items-center">
                  <div class="col-6 text-center">
                    <div class="squircle bg-primary justify-content-center">
                      <i class="fe fe-droplet fe-32 align-self-center text-white"></i>
                    </div>
                    <p>Droplet</p>
                  </div>
                  <div class="col-6 text-center">
                    <div class="squircle bg-primary justify-content-center">
                      <i class="fe fe-upload-cloud fe-32 align-self-center text-white"></i>
                    </div>
                    <p>Upload</p>
                  </div>
                </div>
                <div class="row align-items-center">
                  <div class="col-6 text-center">
                    <div class="squircle bg-primary justify-content-center">
                      <i class="fe fe-users fe-32 align-self-center text-white"></i>
                    </div>
                    <p>Users</p>
                  </div>
                  <div class="col-6 text-center">
                    <div class="squircle bg-primary justify-content-center">
                      <i class="fe fe-settings fe-32 align-self-center text-white"></i>
                    </div>
                    <p>Settings</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
    </main> <!-- main -->
  </div> <!-- .wrapper -->

  <script>
    // Fetch sidebar content and insert into #sidebar
    fetch("sidebar.html")
      .then(response => response.text())
      .then(data => {
        document.getElementById("sidebar").innerHTML = data;
        document.getElementById("productinventory").classList.remove("nav-link");
      });
    fetch("top-nav.html")
      .then(response => response.text())
      .then(data => {
        document.getElementById("topnav").innerHTML = data;

      });
  </script>
  <script src="js/jquery.min.js"></script>
  <script src="js/popper.min.js"></script>
  <script src="js/moment.min.js"></script>
  <script src="js/bootstrap.min.js"></script>
  <script src="js/simplebar.min.js"></script>
  <script src='js/daterangepicker.js'></script>
  <script src='js/jquery.stickOnScroll.js'></script>
  <script src="js/tinycolor-min.js"></script>
  <script src="js/config.js"></script>
  <script src='js/jquery.dataTables.min.js'></script>
  <script src='js/dataTables.bootstrap4.min.js'></script>
  <script>
    // $('#dataTable-1').DataTable(
    //   {
    //     autoWidth: true,
    //     "lengthMenu": [
    //       [16, 32, 64, -1],
    //       [16, 32, 64, "All"]
    //     ]
    //   });
    // $('#dataTable-2').DataTable(
    //   {
    //     autoWidth: true,
    //     "lengthMenu": [
    //       [16, 32, 64, -1],
    //       [16, 32, 64, "All"]
    //     ]
    //   });
      // Initialize the DataTable
const dataTable = $('#dataTable-1').DataTable({
    autoWidth: true,
    "lengthMenu": [
        [16, 32, 64, -1],
        [16, 32, 64, "All"]
    ]
});


function addRowToDataTable(data) {
    const statusClass =
        data.statusOfStock === "In Stock"
            ? "text-green"
            : data.statusOfStock === "Low Stock"
            ? "text-yellow"
            : "text-red"; // Default to "Out of Stock"

    dataTable.row.add([
        data.no, // Column 1: No
        data.name, // Column 2: Name
        data.description, // Column 3: Description
        `â‚± ${data.price.toFixed(2)}`, // Column 4: Price
        data.category, // Column 5: Category
        `<img src="${data.imageUrl}" alt="Product Image" style="width: 50px; height: 50px;">`, // Column 6: Image
        `<p class="${statusClass}">${data.statusOfStock}</p>`, // Column 7: Status with dynamic class
        data.stock, // Column 8: Stock
        data.sku, // Column 9: SKU
        data.lastUpdated // Column 10: Last Date Updated
    ]).draw(); // Refresh the table
}

  </script>
  <script src="js/apps.js"></script>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-56159088-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }
    gtag('js', new Date());
    gtag('config', 'UA-56159088-1');
  </script>

<script src="./config.js" ></script>
<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js" ></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/js/toastr.min.js"></script>
<script src="./js/script.js"></script>

<script>
$.noConflict();
  const uploadImageInput = document.getElementById('uploadImageInputProduct');

  const productImage = document.getElementById('imgProductSelected')

  let imageFileUploadedUrl = ""

  const addProductForm = document.getElementById('frmAddProduct')

  const cardInStock = document.getElementById('cardInStock')
  const cardLowStock = document.getElementById('cardLowStock')
  const cardOutOfStock = document.getElementById('cardOutOfStock')
  const cardAverageItemValue = document.getElementById('cardAverageItemValue')

  async function GetData() {
    try {
        const token = localStorage.getItem("token");
        const body = {
            "fromDate": null,
            "toDate": null,
            "filterType": null,
            "filterData": null,
            "pageNumber": 1,
            "pageSize": 100
        };

        const request = await fetch(serverUrl + "/product/getAllByFilter", {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${token}`
            },
            body: JSON.stringify(body)
        });

        if (!request.ok) {
            throw new Error('Network response was not ok');
        }

        const response = await request.json();

        console.log("data tables: ", response);
        let inStock = 0
        let lowStock = 0
        let outOfStock = 0
        let averageItemValue = 0.00
        if (response.messages.code === 0) {
          

            // Clear existing rows
            dataTable.clear();

          

            response.response.forEach((item, index) => {

              if(item.statusOfStock === "Low Stock"){
                lowStock++
              }

              if(item.statusOfStock === "In Stock"){
                inStock++
              }

              if(item.statusOfStock === "Out of Stock"){

                outOfStock++

              }

              averageItemValue += item.price


                        addRowToDataTable({
              no: index + 1,
              name: item.name,
              description: item.description,
              price: item.price,
              category: item.category,
              imageUrl: item.imageUrl,
              statusOfStock: item.statusOfStock,
              stock: item.stock,
              sku: item.sku,
              lastUpdated: new Date(item.updatedAt).toLocaleDateString() // Format the date
          });
            });

        }
        cardInStock.innerHTML = inStock
        cardLowStock.innerHTML = lowStock
        cardOutOfStock.innerHTML = outOfStock
        cardAverageItemValue.innerHTML = "â‚± "+averageItemValue.toFixed(2)

    } catch (e) {
        console.error("Error fetching data: ", e);
    }
}
  addProductForm.addEventListener('submit', async function (event) {
            event.preventDefault(); // Prevent the default form submission

            try {
            const name = document.getElementById('addProductName').value;
            const description = document.getElementById('addProductDescription').value;
            const price = parseFloat(document.getElementById('addProductPrice').value);
            const category = document.getElementById('categoryProduct').value;
            const imageUrl = imageFileUploadedUrl;
            const stock = document.getElementById('addProductStock').value;
            const token = localStorage.getItem("token");
            

                const body = {  
                                "sku": "test",
                                name,
                                description,
                                price,
                                category,
                                imageUrl,
                                stock
                            }

                console.log("body: ", body);
                // Call the function to add the product
               
                        const response = await fetch(serverUrl + "/product/add", {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                                'Authorization': `Bearer ${token}`
                            },
                            body: JSON.stringify(body)
                        });

                        if (!response.ok) {
                            throw new Error('Network response was not ok');
                        }

                        const data = await response.json();

                        if (data.messages.code === 0) {
                            toastr.success("Product added successfully!");
                            // Optionally, you can reset the form after submission
                            $('#modalAddProduct').modal('hide'); // Close the modal
                            addProductForm.reset();
                        } else {
                            toastr.error(data.messages.message);
                        }

          } catch (error) {
                        console.error("Error adding product: ", error);
                        toastr.error("Error adding product: " + error.message);
                        $('#modalAddProduct').modal('hide'); // Close the modal
         }
          
  })

  async function UploadFileToServer(file){

    try{

      const formData = new FormData();
      formData.append('file', file);

      const response = await fetch('https://filipworks.com/api5/api/v1/uploadapi/upload/file/', {
        method: 'POST',
        body: formData
      });

      if (!response.ok) {
        throw new Error('Network response was not ok');
      }

      const data = await response.json();

      if (data.messages.code === 0) {
    console.log('File uploaded successfully:', data);
    imageFileUploadedUrl = data.response.fileUrl;

    // Check and replace the URL if it starts with "http://localhost:3024/"
    if (imageFileUploadedUrl.startsWith("http://localhost:3024/")) {
        imageFileUploadedUrl = imageFileUploadedUrl.replace("http://localhost:3024/", "https://filipworks.com/api5/");
        console.log("Updated URL:", imageFileUploadedUrl);
    }

    if (imageFileUploadedUrl) {
        productImage.src = imageFileUploadedUrl;
    }
    toastr.success("File uploaded successfully");
    return true;
   }

      
    }catch(e){
      console.error("Error uploading file: ", e);
      toastr.error("Error uploading file: " + e.message);
      return false
    }


  }

  uploadImageInput.addEventListener('change', function (event) {
    const file = event.target.files[0];
    if (file) {
      // Check if the file is an image
      if (file.type.startsWith('image/')) {
        const reader = new FileReader();
        reader.onload = function (e) {
          // Set the image source to the uploaded file
          
          if(UploadFileToServer(file)){
            productImage.src = e.target.result;
          }
          

        };
        reader.readAsDataURL(file);
      } else {
        // Show an error message if the file is not an image

        toastr.error("Please upload a valid image file.");
        uploadImageInput.value = ''; // Clear the input
      }
    }
  });

    // Call GetData every 3 seconds
setInterval(() => {
    GetData();
}, 3000); // 3000 milliseconds = 3 seconds

</script>

</body>

</html>